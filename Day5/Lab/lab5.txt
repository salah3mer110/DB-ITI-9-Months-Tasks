use ITI
--1.	Retrieve number of students who have a value in their age. 
select count(St_Id)
from Student
where St_Age is not null


select distinct Ins_Name 
from Instructor


select St_Id "Student ID", isnull(St_Fname,'')+' '+isnull(St_Lname,'') "Student Full Name",ISNULL(Dept_Name,'') "Department name"
from Student s join Department d
on s.Dept_Id=d.Dept_Id


select Ins_Name, Dept_Name
from Instructor i left outer join Department d
on i.Dept_Id = d.Dept_Id


select St_Fname+' '+St_Lname "Full Name", Crs_Name
from Student s join Stud_Course sc 
on s.St_Id = sc.St_Id
join Course c
on sc.Crs_Id=c.Crs_Id
where Grade is not null



select count(crs_id) "Course Count",Top_Name
from Course c join Topic t
on c.Top_Id=t.Top_Id
group by Top_Name


select min(Salary), max(salary)
from Instructor


select Ins_Name
from Instructor
where Salary < (select avg(Salary) from instructor)


select Dept_Name
from Department d join Instructor i
on d.Dept_Id=i.Dept_Id
where Salary in (select min(Salary) from Instructor)


select top(2) salary
from Instructor
order by Salary desc


select Ins_Name,coalesce(convert(varchar(20),Salary),'Instructor bonus')
from Instructor


select avg(salary)
from Instructor


select s.St_Fname,sup.*
from Student s join Student sup
on s.St_Id=sup.St_super


select Salary
from (select salary, ROW_NUMBER() over (partition by dept_id order by salary desc) as RN
from Instructor
where Salary is not null) newtable
where RN <=2



select * from (select * , ROW_NUMBER() over (partition by dept_id order by newid()) as RN
from Student) newtable
where RN=1

use Adventureworks2012


----------------------------------------------

--1.	Display the SalesOrderID, ShipDate of the SalesOrderHeader
--table (Sales schema) to show SalesOrders that occurred within the period ‘7/28/2002’ and ‘7/29/2014’
select SalesOrderID, ShipDate
from Sales.SalesOrderHeader
where ShipDate between '07-28-2002' and '07-29-2014';


--2.	Display only Products(Production schema) with a StandardCost below $110.00 (show ProductID, Name only)
select ProductID , name  from Production.Product
where StandardCost < 110



--3.	Display ProductID, Name if its weight is unknown
select ProductID , name ,Weight from Production.Product
where Weight   is null 


--4.	 Display all Products with a Silver, Black, or Red Color
select ProductID , name  from Production.Product
where Color  in ('Silver' , 'Black' ,'red') ; 


--5.	 Display any Product with a Name starting with the letter B
select * from  Production.Product 
where name  like 'B%'


--6.	Run the following Query
UPDATE Production.ProductDescription
SET Description = 'Chromoly steel_High of defects'
WHERE ProductDescriptionID = 3


--Then write a query that displays any Product description with underscore value in its description.
select *
from Production.ProductDescription
where Description like '%[_]%';


--7.	Calculate sum of TotalDue for each OrderDate in Sales.SalesOrderHeader table for the period between  '7/1/2001' and '7/31/2014'
select OrderDate , sum(TotalDue) as TotalSum
from Sales.SalesOrderHeader
where OrderDate between '2001-07-01' and '2014-07-31'
  group by OrderDate ;


--8.	 Display the Employees HireDate (note no repeated values are allowed)
select   distinct HireDate  from HumanResources.Employee ;


--9.	 Calculate the average of the unique ListPrices in the Product table
select avg(distinct isnull(ListPrice, 0))  as 'avg'from Production.Product;


--10.	Display the Product Name and its ListPrice within the values of 100 and 
--120 the list should has the following format "The [product name]
--is only! [List price]" (the list will be sorted according to its ListPrice value)
select 
    'The ' + Name + ' is only! ' +convert ( varchar , ListPrice ) as [Product Info]
from Production.Product
where ListPrice between 100 and 120
order by ListPrice;



--11.	
--a)	 Transfer the rowguid ,Name, SalesPersonID, Demographics from Sales.Store table  in a newly created table named [store_Archive]
--Note: Check your database to see the new table and how many rows in it?
select rowguid, Name, SalesPersonID, Demographics into store_Archive
from Sales.Store;


--b)	Try the previous query but without transferring the data? 
select rowguid, Name, SalesPersonID, Demographics
into store_Archive_empty from Sales.Store
where 1 = 0;



--12.	Using union statement, retrieve the today’s date in different styles using convert or format funtion.
select convert ( varchar , getdate() )
union
select format(getdate(), 'dd, MM , yyyy')
